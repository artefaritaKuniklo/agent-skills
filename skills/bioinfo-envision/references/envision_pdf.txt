

--- PAGE 1 ---

数据分析部门项目分析标准v5.0
数据分析部2025年11月
分析人员须知
项目责任制：项目分配后，该项目由分析人员全权负责，分析人员须确保结果专业准确、
项目周期正常、结果可复现等；
项目责任制由项目进入分析开始，到项目结题为止；
项目责任制落实过程中遇到的任何问题，须由分析人员自己主动想办法解决，包括但不限
于：google、百度、寻求同事帮助、修改分析方案等。
一、各个分析点的标准要求
1.数据下载
（1）GEO数据库中高通量测序数据不建议使用NCBI官网定量之后的数据，如果使用官网
定量的数据需要核对样本信息；样本信息不对判定为重分析（比如代码下载NCBI整理好的
是6个疾病样本，但是作者提供的原始数据是7个样本）。
（2）注释文件给定基因symbol的（有时候symbol列名字是不一样的，自行判断列名），
禁止自己再用bitr或其他方法自己转换基因symbol。
（3）需要做基因symbol转换，不允许用探针ID做差异。注释文件版本要用正确，比如
TCGA数据的注释文件为genecodev36。
（4）预后项目，病人样本不要有重复（比如TCGA-DD-A114-01A与TCGA-DD-A114-01B
为重复样本）。
（5）训练集、验证集、单细胞数据集的疾病定义（发病部位，病情的严重程度）、取样人
群（性别、成人、儿童）、组织类型均需要尽量保持一致。
（6）方向基因要进行确认，比如方向基因有的是两个基因连在一起的。
2.差异分析
(1)软件使用：
1Count：DESeq2
2芯片：limma

--- PAGE 2 ---

(2)阈值筛选
1统计学差异：优先使用padj；
2最低标准pvalue<0.05&abs(logfc)>0.5；
3比最低标准更低（只用pvalue、只用padj、降低logfc三种形式）需要申请，提供
参考文献，并与客户确认。
4差异基因的数量不能过少，如少于100，需要反馈主管确认是否可行。
5差异基因的数量过多不能做ppi网络的话，可以适当提高logFC值，有参考文献即
可。
(3)注意事项：
1提前做PCA图和箱线图，如图观察组内样本是否存在批次，依情况可剔除离群样
本；后续也需要观察热图表现；
2禁止数据集合并、再去批次做差异的情况；方案明确写明是可以的。（需要合并要
和方案提前沟通，且需要同平台才能合并）
3分组文件和表达矩阵文件的样本排序需要一致
(4)分组顺序：
1DESeq2的result函数返回的结果中第一行可以查看差异分析的分组顺序；
2limma包的make.contrast函数可以查看差异分析的分组顺序，其结果中的+1为
Case，-1为Control，则差异分析为CasevsControl。
注意：1、fpkm、tpm、标准化后的count数据不可以进行差异分析；
2、log2(count+1)的数据不能用于任何分析；
3、log2(fpkm+1)或者log2(tpm+1)用于除差异分析之外的其他分析。
4、如何和内部或者客户确认过使用特殊阈值，需要在报告中说明。
5、高通量数据，即同时有count和fpkm或tpm数据的数据集，只有差异基因使用rawcount
数据，其余的分析都是使用fpkm或tpm数据【注：除了差异分析，其余分析点使用fpkm
或tpm需要统一，不可混用】
6、高通量测序的数据集，如果没有提供count数据，该数据集是不能用来做训练集，不能做
差异分析的。
7、fpkm、tpm需要查看是否经过标准化，if判断语句有时候可能会出现偏差，需要用range
语句进行判断数据是否合格，一般标准化的数据都是不超过50的。
3.WGCNA
(1)样本总数不低于15个，不区分组别，比如5vs10也可用；
(2)评分或者免疫浸润丰度作为性状时，wgcna分析的前提条件（具体参见下一条）：
1诊断类型项目：评分或者丰度需要在疾病vs对照组间差异显著

--- PAGE 3 ---

2预后类型项目：评分或者丰度需要在肿瘤样本中KM显著
(3)注意报告写清楚样本类型：全部样本还是仅疾病样本？
(4)输入数据矩阵需要标准化后的表达矩阵，如果是高通量数据，使用TPM或者FPKM数
据（需要确认数据是否经过了log2处理）--需要跟其他分析点使用的数据保持一致；
(5)基因表达矩阵剔除低表达或不表达的基因；
(6)软阈值筛选时，需考虑R^2值需卡到0.8（最低0.8，推荐0.85、0.9），同时考虑平均
连接度200以下的；一般选择刚好满足以上两个条件的第一个软阈值；
(7)模块筛选时，候选模块的最低要求：模块与特征的相关性系数|r|>0.3&pvalue<0.05，
优先选择|r|最高模块，其次考虑正负相关|r|最高者，最后考虑选择满足筛选条件的所有
模块。（灰色模块没有意义，不能纳入选择），相关性分析的方法，使用的是pearson。
(8)MM和GS阈值选择：GS>0.2、MM>0.8(支持文献：PMID：36311726）；其他阈值
阈值也可以，但需要提供文献。
(9)基因表达矩阵需要用所有基因，错误示例：使用差异基因的表达矩阵。
(10)模块数需要适中，可通过调整聚类参数进行调整。
4.利用第三方基因集进行评分计算：
(1)注意样本类型：全部样本还是仅疾病样本？
(2)建议method优选选择“ssGSEA”。
(3)方向基因做评分时，方向基因个数要大于10小于200
(4)ssGSEA最低不能低于10个基因，30个以上比较好
(5)关键指标
1预后项目疾病样本中评分有生存差异；
2诊断项目需要关注评分在疾病和正常组间的差异。
5.基因（蛋白）网络构建
(1)PPI
1基因数量最低10个，最多不能超过2000；
2尽量不要PPI网络来直接筛选关键基因，最好结合cytoscape软件中的cytohubba
插件中多种算法联合来筛选，不要主观的人为判断（需要关注所选的TOP基因对
应的分值），每种算法的结果需要保存对应的图片（.pdf）；
3使用多种算法筛选基因时，注意基因不要有并列的情况，比如选择top10，排名第
10个基因与第11个基因得分一致。调整方法：换其他算法、改变选择的top基因
数目，或者使用大于degree的中位数或2倍中位数。（注意必须保存PPI的算法筛
选Top基因时对应算法下所有基因的结果表格，审核人员会检查是否存在并列基
因的情况）

--- PAGE 4 ---

4孤立靶点：展示互作关系的话就保留；筛选基因的话就去掉；
5PPI的目的分两种情况：
1)仅用PPI来展示基因之间的关系
2)仅用PPI来缩小基因数目，提取网络中的核心基因进行后续分析；（这里需要
注意上述第2点）
3)如何区分上述2个目的：由下游分析决定，分析人员需要自己判断，拿不准的
和主管商量。
6STRING筛选的参考（置信度阈值）必须交代清楚。
7用cytoscape美化完ppi网络后，需要保存当前环境（.cys格式数据）
8若PPI基因数目较多，不便于展示，可选择部分基因进行展示，比如按照degree
排序top30进行绘图。
(2)GeneMINIA
1输入基因不宜过多，建议10个以下；
2互作网络上要将输入基因和非输入基因区分展示；
3图上需要展示疾病潜在相关生物学过程。
6.单基因ROC分析
(1)诊断ROC中AUC>0.7且不能等于1（备注：AUC=1不能用来筛选基因，通过调整前
面的分析方法把这个基因去掉）；
(2)样本量不宜过少，满足8-vs-8以上（小于这个样本数需要申请）；
(3)图中线条颜色区分度需要很明显，标签字体不宜过小；
(4)在训练集中，单基因ROC的AUC值必须通过（0.7），验证集的不通过可以不考虑验证
集结果；如果基因数目过多时，可以提高单基因roc的阈值，比如0.8、0.9来进一步筛
选基因，降低基因数目。
7.单基因表达量分析
(1)要求趋势一致且统计学检验差异显著；
(2)通过验证的数目至少2个；
(3)关键基因数目：
1诊断类型最多5个；必须要有单基因表达量外部验证，没有需要申请；
2预后类型最多8个；
(4)训练集首选统计学检验的结果，如果不显著，则替换为差异分析的统计学结果；验证
集用统计学检验方法即可，验不过去可以换用差异分析的统计学结果。
(5)count和fpkm的差异趋势不一致时，首选先对count数据做vst标准化分析，做秩和

--- PAGE 5 ---

检验，其次看平均数（注意：当对count数据做了vst标准化分析时，其他分析点所用
数据需要统一为vst标准化数据，保持一致）
(6)诊断验证基因数目：用于做表达验证分析的基因总数最多15个，验证通过的比例不低
于20%，15过3。
(7)验证集缺少基因的情况：最多缺失一个基因，超过1个需要重新调整或者换验证集。
8.诊断模型ROC
(1)模型ROC需AUC>0.7，模型的AUC值需要大于单基因的AUC值，如果不是可将单基
因的ROC去掉；
(2)模型的ROC的AUC和基因ROC的AUC值不允许等于1，可替换为：
1混淆矩阵
2PR曲线
3C-index
(3)样本量不宜过少，满足8-vs-8以上；
(4)图中线条颜色尽量采用深色，标签字体不宜过小；
(5)图中标注最佳截距值；95%置信区间；
9.机器学习
(1)样本量不宜过少，满足8-vs-8以上（小于这个样本数需要申请）；
(2)交叉倍数：需要根据样本量确定：一般来说，十几个样本用3折，其他可以用5折或
10折；每折样本不要太少，最低不得少于3个样本；折数可用3、5、10，其他不建议
使用。
(3)尽量自限性的方法和自限性的取交集、非自限性和非自限性取交集。如果实在取不到，
可以互相取交集；
(4)分组因子水平的设定：正常对照是0、疾病是1
(5)机器学习目的：
1会筛选出基因；
2不筛选基因，但会输出重要度（可以根据重要度去挑选）；
3不筛选基因，也没有重要度（分类模型，看模型的效果如何）。
(6)不同种机器学习算法整理：
1SVM-RFE版本：系统会筛选基因，可直接用作特征基因（同时也会得出这些基因
的重要度）【注：模型的错误率不得为0，精确度不得为1】
2Lasso（alpha=1）：系统会筛选基因，可直接用作特征基因（同时也会得出每个
基因的系数）

--- PAGE 6 ---

3LR-逻辑回归：构建的是分类模型，系统不筛选基因，也不能输出变量的重要度
4RF-随机森林：系统不筛选基因，但能输出变量的重要度【注：模型的错误率不得
为0，精确度不得为1】
5GBDT（GBM）：系统不筛选基因，但能输出变量的重要度
6XGBOOST：系统会帮助筛选基因，可直接用作特征基因（同时也会得出这些基因
的重要度）（列名只能是字母，不能有数字）
7SVM-svm版本（简单版）：构建的是分类模型，系统不筛选基因，也不能输出变量
的重要度
8ANN（人工神经网络）：在算法的实际应用中，很多时候我们都需要明确哪些输入
变量对输出变量的预测更为重要，而神经网络中的权重仅作为节点的连接强度测
度，它是无法直观揭示输出变量的重要性的。（参考：
https://zhuanlan.zhihu.com/p/26639584）
9Boruta：系统会筛选基因，可直接用作特征基因（同时也会得出这些基因的重要度）
(7)如果机器学习需要筛选基因，如进入机器学习的基因数是10个，出的基因数也为10
个，需要更换其他算法。
10.预后模型
1、2个概念：
1预后风险模型：基因构建的模型；
2独立预后模型：风险模型riskScore和临床特征构建的模型。
2、单因素cox（需要先针对每个因子单独做PH假定检验，PH假定检验阈值PH.p>0.05）：
阈值p<0.05\0.01\0.2；首选0.05（置信区间0.95）；最大p0.2（当P<0.2时，需要更改置
信区间为0.8）；最小不限，但需要文献支持；
3、构建模型方法：
(1)lasso-cox；
(2)多因素cox（需要先针对全部因子做PH假定检验）；
(3)逐步回归；
(4)CoxBoost；
(5)randomForestSRC；
4、风险模型：
(1)单+lasso;
(2)单+多；
(3)单+RSF；
(4)单+lasso+多;

--- PAGE 7 ---

(5)单+lasso+RSF；
注意：多因素模型里的基因p值允许不小于0.05，但是ph检验要全部大于0.05；
多因素模型后可加逐步回归，同样基因p值允许大于0.05，但是ph检验要全部大
于0.05。
逐步回归本质上是要求：模型已经是唯一的、最好的模型，才允许多因素模型里的
基因p值允许大于0.05；
5、独立预后模型必须包含riskScore和至少1个特征；如果只有riskScore，则不构建列线
图；
6、预后模型构建列线图：
(1)需要用独立预后因素构建列线图：单因素+多因素的阈值需要小于0.05
(2)列线图性能评估标准
1构建的列线图的AUC值需要大于0.6
2需要另一个评估指标也通过
1)校准曲线p>0.05
2)DCA曲线结果显示模型的性能优于单一变量
7、预后类型的ROC关于年份的要求
(1)训练集和验证集（年份一致）的AUC均大于0.6；
(2)构建的ROC曲线使用不是常规的1，3，5年的数据，都需要额外提供对应的参考
文献
8、训练集和验证集的生存类型（OS、PFS、DFS或其他）和生存时间单位（年、月、天）
要统一。
11.GSEA
(1)如果使用clusterProfiler包的函数，注意结果是否有随机性，可使用seed参数避免；
(2)背景基因集优先选取KEGG；
(3)单基因GSEA可采用的排序方式：高低表达组的差异结果LogFC、单基因和全部基因的
相关性
(4)单基因GSEA的分析，需要做共有通路的GSVA分析。
(5)阈值：|NES|>1&p<0.05（adjust.P<0.05)。没有其他可申请的阈值
12.GSVA
(1)阈值：|t|>1（最低是0）&p<0.05（adjust.P<0.05)，;差异分析用limma包。
13.富集分析：KEGG、GO

--- PAGE 8 ---

(1)优先考虑校准P值；
(2)用来富集的基因数目不得少于10个，若少于10个，转为单基因GSEA；
14.分子对接
(1)需要写清楚选择化合物对接的理由；
(2)需要说明结合能，结合能最大值：-1.2kcal/mol（PMID:39893380）or-5kj/mol（PMID:
39310787）；
(3)图的形式：一张大图+一张局部放大图；
(4)需要说明蛋白的来源或者PDB的ID（如果遇到蛋白结构只是螺旋链，建议蛋白不要用
卡通形式展示，可以用棍棒形式展示）。
15.ceRNA网络、TF/miRNA-mRNA、TF-miRNA-mRNA
(1)多数据库预测结果的交集，必须是关系对的交集而不能仅是靶点的交集；
(2)正文里面需要描述结果有多少个节点、关系对等信息；
16.免疫治疗
(1)TIDE
(2)IPS
17.免疫浸润：
(1)非肿瘤可以做免疫浸润；
(2)多种算法：cibersort、ssGSEA、xCell、Timmer等（小鼠可用CIBERSORT、ssGSEA）；
(3)可以使用R包immunedeconv。
(4)更新了细胞的名称，需要按照新的版本
18.聚类（一致性聚类）：

--- PAGE 9 ---

(1)样本数：最小样本数应为30；
(2)一致性聚类：CDF曲线，最快到达平台期的K和热图；
(3)NMF：热图和折线图：斜率下降最快的前一个点；
(4)关键指标
1预后项目：类间生存要有差异；
2非预后项目：类间要有差异
1)具有临床的意义
2)具有功能意义
a.信号通路来源的方向，类间该通路评分要有差异
b.类间KEGG通过有差异：
c.类间GSVA通路有差异；
19.药物敏感性预测：药物数目多的时候：和riskScore的相关性，高相关的去做箱线图展示。
20.各种相关性系数最低阈值0.3；相关性系数方法注意pearson和spearman的区别，除非确
定数据分布类型，否则不建议使用pearson；
21.MR（孟德尔随机化分析）的OR值和基因表达的上下调不需要一致（也可以按照上下调筛
选）
22.MR的OR值和单因素cox的HR值要一致（如果基因是暴露因素）（预后类型）
23.MR的留一法检验不能跨线（不管什么类型的项目）
24.单细胞的质控条件必须满足三个方面，阈值不做强行要求，但需要文献支持
(1)细胞数
(2)基因数
(3)线粒体占比
25.以下值如果出现特别大，可以判定为异常者去除
(1)OR值
(2)HR值，比如单因素cox去除异常基因，一般是因为基因表达量较低，可以在原始数据
处理或者差异分析那里过滤低表达基因。过滤低表达基因的标准不做规定。
(3)CI（置信区间）
26.hdwgcna
(1)性状不要用疾病，可以用细胞或方向基因集评分去筛选基因模块
(2)关键细胞的筛选：可以基于几个关键基因计算AUCell评分
27.单基因项目
(1)疾病对照之间，基因要有表达差异

--- PAGE 10 ---

(2)差异表达的趋势要和主流文献一致
(3)需要看方案的思路：要思考单基因是否有特殊的调控（TF，某种修饰的：甲基化，泛
素化等等）
28.单细胞分析
（1）细胞注释：marker基因不能来源于文献findallmarkers函数得到的top特征基因，并且单
一细胞类型的marker基因数量尽量不用1个基因；报告中需要补充细胞类型-marker基因-细胞
簇的列表、未注释前cluster的marker基因表达气泡图。
（2）要求至少有一个关键基因在关键细胞中高表达，并且有时序差异，没有差异需要反馈主管。
（3）单细胞关键细胞的选择需要尽量与转录组的组织类型相一致，如转录组是肾小球组织，单
细胞关键细胞需要尽量选到肾小球或肾小球相关的细胞类型。
（4）如果方向是特殊的免疫细胞相关，在免疫浸润部分，需要关注是否有差异，单细胞需要把
对应的免疫细胞选做关键细胞。
29.单细胞受配体项目
（1）复合蛋白需要拆开。
（2）要注意方案设计是在疾病样本中进行，还是所有样本中进行。疾病样本或所有样本都可以
进行分析的。
（3）要注意方案设计是对于所有细胞类型间进行的细胞通讯，还是仅针对关键细胞和其他细胞
间。两种方法都可以。
（4）需要使用通讯概率默认阈值p<0.05的，若受配体基因不够多，需要扩大的话，可以查找
文献寻找合适的阈值进行，向主管特殊申请。
30.方向基因的扩充
（1）药物或疾病的靶基因不能进行方向基因的扩充。
（2）药靶和疾病靶点，优先多数据库取交集，若效果不好，可取并集。
31.graphban分析
（1）pred最低阈值是0.5（三个模型同时）。
（2）最优3个模型取交集，也可以用2个模型取交集或者只用1个模型，但是需要说明选择理
由。
（3）根据分析目的不同，在构建蛋白-成分关系对时，需要注意是排列组合全连接（活性成分-
差异基因）、还是按照固定关系对（前面已经用数据库预测了活性成分-靶基因关系对）进行分
析。
（3）后续的类药性和毒理性评估，如果不使用方案中的阈值，需要提供阈值的参考文献。如果
各种毒理参数阈值都过不去的话，可以删掉毒理性评估这一分析点。
（4）最后调控网络需要保留至少2个关键基因，活性成分尽量不唯一，并且要注意成分是否有

--- PAGE 11 ---

价值。
32.网药项目
（1）药物需要找全，尤其是复方中的药物，如果未找全，需要对接客户确认。
（2）药物别名要有参考依据，如《药典》（比如芍药在中药中被分为白芍和赤芍，在临床用药
中对应症状不同，需要跟客户确认到底是哪一种）。
（3）要注意tcsmp和batman使用的筛选阈值，并且在报告中描述。
（4）要保留网站下载的原始数据，整合的文件需要包括药物-活性成分-靶基因列表。
33.多组学联合分析
（1）正常-模型；模型-治疗；模型-干预（更严重），差异基因注意要反向还是同向取交集。
（2）相关性分析的前提是，需要保证各组学的样本来源于同一个体，如蛋白组的A1、代谢组
的A1、微生物组的A1，需要是一只鼠。
（3）需要关注最终筛选出的代谢物、微生物是否有价值，如代谢物是内源还是外源，微生物是
否是污染菌，无实际意义。
34.任何项目均需要对关键结果评估创新性
（1）诊断项目：关键基因是否是PCR、WB等实验的内参基因（比如GADPH），是不是已有大
量文献报道和疾病相关。
（2）预后项目：预后基因是否已有大量文献报道，并且我们的HR值是否和其他文献一致。
（3）数据库项目：暴露是否已有文献报告，临床模型最后筛选出的关键指标是否是很通用的，
没有价值的指标，如血压，年龄，性别，激素等。暴露因素的or值是否和已有文献相同，是否
符合常规逻辑，如同患病多是危险因素。
二、特殊情况注意要点
1.急性髓系白血病：TCGA数据取样部位为外周血（血液样本），GEO数据大部分取样
部位为脊髓，鉴于文献中也是TCGA和GEO数据混用，所以可以用GEO骨髓数据集进
行验证。
2.预后分析项目，之后宫颈癌、甲状腺癌、子宫内膜癌可以申请不用外部验证集，采用7:3+
整体验证的方式，其余癌症均需要外部验证集（即使7:3+整体验证也需要有外部验证集），模型
调整不出来优先考虑换方向。
3.预后ROC曲线，需要注意满足生存时间的样本是否足够。比如要画3/5/7年的ROC，7年生
存样本不够的情况下（至少要有1个样本），不允许画到7年的，换其他年份。ROC的曲线不能
完全重合。
4.以下数据集属于同源数据，禁止在同一研究中将其分别用作训练集和验证集。膜性肾病：
GSE108113、GSE200828；牙周炎：GSE16134、GSE10334；溃疡性结肠炎：GSE87466、GSE92415。